{% extends "core/base1.html" %} {% load static %} {% block content %}

<!-- Dashboard Section start -->
<section class="dashboard-section body-collapse pay step step-2">
  <div class="overlay pt-120">
    <div class="container-fruid">
      <div class="main-content">
        <div
          class="head-area d-flex align-items-center justify-content-between"
        >
          <h4>Make a Payment</h4>
          <div class="icon-area">
            <img src=" " alt="icon" />
          </div>
        </div>
        <div class="choose-recipient">
          <div class="step-area">
            <span class="mdr">Step 2 of 3</span>
            <h5>Set Amount of transfer</h5>
          </div>
          <div class="user-select">
            <div class="single-user">
              <div class="left d-flex align-items-center">
                <div class="img-area">
                  <img
                    src="{{transfer_account.kyc.image.url}}"
                    alt="image"
                    style="width: 60px; height: 60px; border-radius: 50%"
                  />
                </div>
                <div class="text-area">
                  <p>{{transfer_account.kyc.full_name}}</p>
                  <span class="mdr">{{transfer_account.account_number}} </span>
                </div>
              </div>
              <div class="right">
                <a href="javascript:void(0)">
                  <i class="icon-g-tick"></i>
                  Choose
                </a>
                <a href="javascript:void(0)">
                  <i class="icon-h-edit"></i>
                  Edit
                </a>
              </div>
            </div>
          </div>
        </div>
        <form action="#">
          <div class="send-banance">
            <span class="mdr">You Send</span>
            <div class="input-area">
              <input
                id="new-value"
                class="xxlr"
                placeholder="400.00"
                type="number"
                onKeyUp="totalBalance()"
              />
              <select>
                <option value="1">USD</option>
              </select>
            </div>
            <span id="new-balance"></span>
            <p>
              Available Balance:
              <span id="available-balance"
                ><b>{{account.account_balance}}</b></span
              >
            </p>
          </div>
          <ul class="total-fees">
            <li>Total Fees</li>
            <li>Free</li>
          </ul>
          <ul class="total-fees pay">
            <li>
              <h5>Total To Pay</h5>
            </li>
            <li>
              <h5>xx USD</h5>
            </li>
          </ul>
          <div class="footer-area mt-40">
            <a href="pay-step-1.html">Previous Step</a>
            <a href="pay-step-3.html" class="active">Next</a>
          </div>
        </form>
      </div>
    </div>
  </div>
  <script>
    const integerInput = document.getElementById("new-value");

    // Attach an event listener so non integer cant be typed
    integerInput.addEventListener("input", function (event) {
      const inputValue = event.target.value;
      const sanitizedValue = inputValue.replace(/\D/g, "");
      console.log(typeof sanitizedValue);
      console.log(typeof inputValue);
      console.log(inputValue !== sanitizedValue);
      //console.log(filteredValue);
      event.target.value = sanitizedValue;
    });
    integerInput.addEventListener("paste", function (event) {
      // Prevent the default paste action
      event.preventDefault();

      // Get the text from the clipboard
      const clipboardData = event.clipboardData || window.clipboardData;
      const pastedText = clipboardData.getData("text");

      // Filter out non-integer characters
      const filteredText = pastedText.replace(/\D/g, "");

      // Insert the filtered text into the input field
      document.execCommand("insertText", false, filteredText);
    });

    function totalBalance() {
      let availableAmount = parseFloat(
        "{{account.account_balance.amount}}"
      );
      let transferAmount = document.getElementById("new-value").value;
      newBalance = availableAmount - transferAmount;
      newBalanceElement = document.getElementById("new-balance");
      if (transferAmount > availableAmount) {
        newBalanceElement.textContent = "insufficient funds";
        newBalanceElement.style.color = "red";
        alert(`you can only send ${{account.account_balance.amount}}`);
      } else {
        newBalanceElement.textContent = `New Balance: $${newBalance
          .toString()
          .replace(/\B(?=(\d{3})+(?!\d))/g, ",")}`;
        newBalanceElement.style.color = "black";
      }

      // console.log(transferAmount);
      // console.log(newBalance);
    }
  </script>
</section>
<!-- Dashboard Section end -->

{% endblock content %}
